<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤æ—©å‘³ç´…é¾œç²¿ DIY åŠ</title>
    <style>
        /* æ•´é«”é¢¨æ ¼ */
        body {
            font-family: "Microsoft JhengHei", "PingFang TC", sans-serif;
            background-color: #fcf3e8;
            color: #4e342e;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 20px;
        }

        h1 { color: #b71c1c; margin-bottom: 10px; }
        .subtitle { margin-bottom: 20px; color: #795548; }

        /* éŠæˆ²å®¹å™¨ */
        #game-box {
            background: white;
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            max-width: 450px;
            width: 100%;
            text-align: center;
        }

        /* ç•«å¸ƒæ¨£å¼ */
        canvas {
            background-color: #fff;
            border: 3px solid #efebe9;
            border-radius: 15px;
            cursor: pointer;
            transition: transform 0.1s ease;
            touch-action: none; /* é˜²æ­¢æ‰‹æ©Ÿç¸®æ”¾ */
        }

        /* æ§åˆ¶å€åŸŸ */
        .section-title {
            font-weight: bold;
            margin: 15px 0 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-group {
            display: flex;
            justify-content: center;
            gap: 8px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        button {
            padding: 10px 18px;
            border: 2px solid #d7ccc8;
            border-radius: 50px;
            background: white;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }

        button:hover { background: #fbe9e7; border-color: #ff8a65; }
        button.active {
            background: #d32f2f;
            color: white;
            border-color: #b71c1c;
            box-shadow: 0 4px 8px rgba(211,47,47,0.3);
        }

        #status-msg {
            background: #fff3e0;
            padding: 10px;
            border-radius: 10px;
            color: #e65100;
            font-weight: bold;
            min-height: 24px;
            margin-bottom: 15px;
        }

        .reset-btn {
            background-color: #5d4037;
            color: white;
            width: 100%;
            margin-top: 10px;
            font-weight: bold;
        }
    </style>
</head>
<body>

    <h1>ğŸ® ç´…é¾œç²¿è£½ä½œå·¥åŠ ğŸ®</h1>
    <p class="subtitle">å‚³çµ±ç¾å‘³ï¼Œç”±ä½ è¦ªæ‰‹æ‰“é€ </p>

    <div id="game-box">
        <div id="status-msg">ç¬¬ä¸€æ­¥ï¼šè«‹å…ˆé¸æ“‡é¤…çš®é¡è‰²</div>
        
        <canvas id="gameCanvas" width="300" height="300"></canvas>

        <div class="controls">
            <div class="section-title">Step 1. é¤…çš®å£å‘³</div>
            <div class="btn-group" id="skin-btns">
                <button onclick="setSkin('#ff5252', 'ç´…éº´(ç´…)', this)" class="active">ç´…éº´ç´…</button>
                <button onclick="setSkin('#9ccc65', 'è‰¾è‰(ç¶ )', this)">è‰¾è‰ç¶ </button>
                <button onclick="setSkin('#ffd54f', 'åœ°ç“œ(é»ƒ)', this)">åœ°ç“œé»ƒ</button>
                <button onclick="setSkin('#ba68c8', 'ç´«è–¯(ç´«)', this)">ç´«è–¯ç´«</button>
            </div>

            <div class="section-title">Step 2. æƒ³è¦åŒ…ä»€éº¼é¤¡ï¼Ÿ</div>
            <div class="btn-group" id="filling-btns">
                <button onclick="setFilling('ç´…è±†', this)">ç¶“å…¸ç´…è±†</button>
                <button onclick="setFilling('èŠ±ç”Ÿ', this)">é¦™é†‡èŠ±ç”Ÿ</button>
                <button onclick="setFilling('é¹¹è›‹é»ƒ', this)">é¹¹è›‹é»ƒ</button>
            </div>
            
            <button class="reset-btn" onclick="resetGame()">ğŸ§¹ æ¸…é™¤æ¡Œé¢ï¼Œé‡åšä¸€å€‹</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const statusMsg = document.getElementById('status-msg');

        // éŠæˆ²è®Šæ•¸
        let gameState = 'CHOOSING_SKIN'; // CHOOSING_SKIN, CHOOSING_FILLING, READY_TO_MOLD, FINISHED
        let skinColor = '#ff5252';
        let fillingType = '';

        // åˆå§‹åŒ–ç•«å¸ƒ
        function init() {
            draw();
        }

        // é¸æ“‡é¡è‰²
        function setSkin(color, name, btn) {
            skinColor = color;
            setActive(btn, 'skin-btns');
            if(gameState === 'CHOOSING_SKIN') {
                gameState = 'CHOOSING_FILLING';
                statusMsg.innerText = `é¸å¥½äº† ${name} çš®ï¼Œæ¥ä¸‹ä¾†è«‹é¸æ“‡å…§é¤¡ï¼`;
            }
            draw();
        }

        // é¸æ“‡å…§é¤¡
        function setFilling(type, btn) {
            fillingType = type;
            setActive(btn, 'filling-btns');
            gameState = 'READY_TO_MOLD';
            statusMsg.innerText = `å·²åŒ…å…¥ ${type} é¤¡ï¼è«‹é»æ“Šä¸Šæ–¹éºµç³°é€²è¡Œã€Œå£“æ¨¡ã€ï¼`;
            draw();
        }

        function setActive(clickedBtn, groupId) {
            const buttons = document.getElementById(groupId).querySelectorAll('button');
            buttons.forEach(b => b.classList.remove('active'));
            clickedBtn.classList.add('active');
        }

        // æ ¸å¿ƒç¹ªè£½é‚è¼¯
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // 1. ç¹ªè£½æœˆæ¡ƒè‘‰å¢Šåº•
            ctx.fillStyle = '#388e3c';
            ctx.beginPath();
            ctx.ellipse(150, 190, 85, 120, Math.PI / 2, 0, Math.PI * 2);
            ctx.fill();
            // è‘‰è„ˆ
            ctx.strokeStyle = '#2e7d32';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(30, 190); ctx.lineTo(270, 190);
            ctx.stroke();

            // 2. ç¹ªè£½ç´…é¾œç²¿ä¸»é«”
            ctx.save();
            ctx.shadowBlur = 10;
            ctx.shadowColor = "rgba(0,0,0,0.2)";
            ctx.fillStyle = skinColor;
            
            ctx.beginPath();
            if (gameState === 'FINISHED') {
                // å£“æ¨¡å¾Œçš„å½¢ç‹€ï¼ˆæ›´æ‰å¹³ã€æ›´å¯¬ï¼‰
                ctx.ellipse(150, 175, 80, 105, Math.PI / 2, 0, Math.PI * 2);
                ctx.fill();
                drawMoldPattern(); // ç•«ä¸Šé¾œæ®¼ç´‹è·¯
            } else {
                // åœ“æ»¾æ»¾çš„éºµç³°
                ctx.arc(150, 170, 65, 0, Math.PI * 2);
                ctx.fill();
                // å¦‚æœé‚„æ²’å£“æ¨¡ï¼Œç•«å‡ºç¨å¾®éš†èµ·çš„ç«‹é«”æ„Ÿ
                let gradient = ctx.createRadialGradient(130, 150, 5, 150, 170, 70);
                gradient.addColorStop(0, 'rgba(255,255,255,0.3)');
                gradient.addColorStop(1, 'transparent');
                ctx.fillStyle = gradient;
                ctx.fill();
            }
            ctx.restore();
        }

        // ç¹ªè£½ç²¾ç´°çš„å£“æ¨¡ç´‹è·¯
        function drawMoldPattern() {
            ctx.strokeStyle = 'rgba(0,0,0,0.15)';
            ctx.lineWidth = 3;
            ctx.setLineDash([]);
            
            // å¤–åœåœ“åœˆ
            ctx.beginPath();
            ctx.ellipse(150, 175, 60, 85, Math.PI / 2, 0, Math.PI * 2);
            ctx.stroke();

            // é¾œèƒŒå…­è§’å½¢ (ç°¡åŒ–ç‰ˆ)
            ctx.beginPath();
            ctx.moveTo(150, 130);
            ctx.lineTo(190, 150);
            ctx.lineTo(190, 200);
            ctx.lineTo(150, 220);
            ctx.lineTo(110, 200);
            ctx.lineTo(110, 150);
            ctx.closePath();
            ctx.stroke();

            // å¯«å€‹ã€Œå£½ã€å­—çš„æ„è±¡ (ä»¥ç·šæ¢ä»£è¡¨)
            ctx.font = "bold 40px serif";
            ctx.textAlign = "center";
            ctx.fillStyle = 'rgba(0,0,0,0.1)';
            ctx.fillText("å£½", 150, 190);
        }

        // é»æ“Šå£“æ¨¡å‹•ä½œ
        canvas.addEventListener('mousedown', () => {
            if (gameState === 'READY_TO_MOLD') {
                gameState = 'FINISHED';
                statusMsg.innerText = `âœ¨ å“‡ï¼å¥½æ¼‚äº®çš„ ${fillingType} ç´…é¾œç²¿å‡ºçˆäº†ï¼`;
                
                // è¦–è¦ºæ‰“æ“Šæ„Ÿå‹•ç•«
                canvas.style.transform = 'scale(0.9) translateY(10px)';
                setTimeout(() => {
                    canvas.style.transform = 'scale(1.05)';
                    draw();
                    setTimeout(() => canvas.style.transform = 'scale(1)', 100);
                }, 100);
            }
        });

        // é‡ç½®éŠæˆ²
        function resetGame() {
            gameState = 'CHOOSING_SKIN';
            fillingType = '';
            statusMsg.innerText = 'é‡æ–°é–‹å§‹ï¼šè«‹å…ˆé¸æ“‡é¤…çš®é¡è‰²';
            // é‡è¨­æŒ‰éˆ•ç‹€æ…‹
            document.querySelectorAll('button').forEach(b => b.classList.remove('active'));
            document.getElementById('skin-btns').firstElementChild.classList.add('active');
            draw();
        }

        init();
    </script>
</body>
</html>
