<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤æ—©å‘³ç²¿åŠ - è·äººè£½ä½œå°éŠæˆ²</title>
    <style>
        :root { --main-bg: #fffcf5; --accent: #d32f2f; --panel-bg: #ffffff; }
        body { font-family: "Microsoft JhengHei", sans-serif; background-color: var(--main-bg); margin: 0; display: flex; flex-direction: column; align-items: center; overflow-x: hidden; }
        
        /* é£Ÿæé¡¯ç¤ºå€ - å…©åˆ—å…©æ¬„æ’åˆ— */
        .ui-header { display: flex; gap: 30px; padding: 25px; background: var(--panel-bg); width: 100%; max-width: 900px; justify-content: center; box-shadow: 0 5px 20px rgba(0,0,0,0.05); border-radius: 0 0 30px 30px; }
        .ingredient-grid { display: grid; grid-template-columns: repeat(2, 120px); grid-template-rows: repeat(2, 120px); gap: 15px; }
        .filling-column { display: flex; flex-direction: column; gap: 15px; }

        .item { background: #fdfdfd; border: 2px solid #eee; border-radius: 15px; position: relative; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: 0.2s; }
        .item:hover { border-color: var(--accent); transform: translateY(-3px); }
        .item img { width: 75px; height: 75px; object-fit: contain; }
        .item span { font-size: 14px; color: #666; font-weight: bold; margin-top: 5px; }

        /* è¨ˆæ•¸æ°£æ³¡ */
        .count-badge { position: absolute; top: -8px; right: -8px; background: var(--accent); color: white; border-radius: 50%; width: 26px; height: 26px; font-size: 14px; display: flex; align-items: center; justify-content: center; border: 2px solid white; font-weight: bold; opacity: 0; transition: 0.3s; }
        .count-badge.show { opacity: 1; }

        /* è’¸ç± å±•ç¤ºå€ */
        .game-main { margin: 40px 0; position: relative; text-align: center; }
        .steamer-base { width: 300px; height: auto; filter: drop-shadow(0 15px 15px rgba(0,0,0,0.1)); }
        #final-product { position: absolute; top: 40px; left: 50%; transform: translateX(-50%) scale(0); width: 130px; transition: 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        #final-product.show { transform: translateX(-50%) scale(1); }

        /* æŒ‰éˆ•æ§åˆ¶ */
        .btn-group { display: flex; gap: 20px; }
        button { padding: 12px 40px; border-radius: 50px; border: none; font-size: 18px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .btn-make { background: var(--accent); color: white; box-shadow: 0 4px 10px rgba(211,47,47,0.3); }
        .btn-reset { background: #efebe9; color: #5d4037; }
        button:active { transform: scale(0.95); }

        /* å½ˆçª—ç³»çµ± */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: none; align-items: center; justify-content: center; z-index: 1000; }
        .modal { background: white; padding: 40px; border-radius: 25px; text-align: center; max-width: 450px; width: 85%; position: relative; }
        .modal h2 { color: var(--accent); margin-top: 0; font-size: 28px; }
        .modal p { font-size: 18px; line-height: 1.6; color: #444; }
        .modal .reward-link { display: none; color: #2e7d32; font-weight: bold; margin-top: 20px; text-decoration: underline; cursor: pointer; }
    </style>
</head>
<body>

    <div class="ui-header">
        <div class="ingredient-grid">
            <div class="item" onclick="select('red')"><img src="ç´…ç±³ç³°.png"><span>ç´…ç±³ç³°</span><div id="cnt-red" class="count-badge">0</div></div>
            <div class="item" onclick="select('white')"><img src="ç™½ç±³ç³°.png"><span>ç™½ç±³ç³°</span><div id="cnt-white" class="count-badge">0</div></div>
            <div class="item" onclick="select('green')"><img src="ç¶ ç±³ç³°.png"><span>ç¶ ç±³ç³°</span><div id="cnt-green" class="count-badge">0</div></div>
            <div class="item" onclick="select('syrup')"><img src="ç±³æ¼¿.png"><span>ç±³æ¼¿</span><div id="cnt-syrup" class="count-badge">0</div></div>
        </div>
        <div class="filling-column">
            <div class="item" onclick="select('sweet')"><img src="ç”œé™·.png"><span>ç”œé¤¡</span><div id="cnt-sweet" class="count-badge">0</div></div>
            <div class="item" onclick="select('salty')"><img src="é¹¹é™·.png"><span>é¹¹é¤¡</span><div id="cnt-salty" class="count-badge">0</div></div>
        </div>
    </div>

    <div class="game-main">
        <img src="https://cdn-icons-png.flaticon.com/512/3227/3227094.png" class="steamer-base">
        <img id="final-product" src="">
    </div>

    <div class="btn-group">
        <button class="btn-reset" onclick="reset()">é‡æ–°é…æ–™</button>
        <button class="btn-make" onclick="make()">é–‹å§‹è£½ä½œ</button>
    </div>

    <div id="modal-overlay" class="modal-overlay">
        <div class="modal">
            <h2 id="m-title">æ¨™é¡Œ</h2>
            <p id="m-desc">å…§å®¹æè¿°</p>
            <div id="reward" class="reward-link" onclick="window.open('https://line.me/S/shop/sticker/xxx')">ğŸ é ˜å–å…¨æˆå°±çå‹µè²¼åœ–ï¼</div>
            <button onclick="closeModal()" style="margin-top:20px; background:#444; color:white;">ç¢ºå®š</button>
        </div>
    </div>

    <script>
        // é£Ÿæèˆ‡æ¬¡æ•¸è¨­å®š
        let cart = { red: 0, white: 0, green: 0, syrup: 0, sweet: 0, salty: 0 };
        let achievements = new Set();

        // ç²¿é¡é…æ–¹è¡¨ (ingredientså°æ‡‰æ¬¡æ•¸)
        const recipeList = [
            { id: '1', name: "ç´…é¾œç²¿", ingredients: { red: 1, sweet: 1 }, img: "ç´…ç±³ç³°.png" },
            { id: '2', name: "èœé ­ç²¿", ingredients: { white: 2, salty: 1 }, img: "ç™½ç±³ç³°.png" },
            { id: '3', name: "ç´…åœ“", ingredients: { red: 1 }, img: "ç´…ç±³ç³°.png" },
            { id: '4', name: "è‰ä»”ç²¿", ingredients: { green: 1, salty: 1 }, img: "ç¶ ç±³ç³°.png" },
            { id: '5', name: "èŠ‹ç²¿", ingredients: { white: 1, syrup: 1, salty: 1 }, img: "ç±³æ¼¿.png" },
            { id: '6', name: "æ¹¯åœ“", ingredients: { white: 1, red: 1 }, img: "ç™½ç±³ç³°.png" }, // æ¹¯åœ“æ–¹å¼1
            { id: '7', name: "æ¹¯åœ“", ingredients: { white: 2 }, img: "ç™½ç±³ç³°.png" }        // æ¹¯åœ“æ–¹å¼2
        ];

        function select(id) {
            cart[id]++;
            let badge = document.getElementById(`cnt-${id}`);
            badge.innerText = cart[id];
            badge.classList.add('show');
        }

        function reset() {
            cart = { red: 0, white: 0, green: 0, syrup: 0, sweet: 0, salty: 0 };
            document.querySelectorAll('.count-badge').forEach(b => {
                b.classList.remove('show');
                b.innerText = "0";
            });
            document.getElementById('final-product').classList.remove('show');
        }

        function make() {
            let successRecipe = null;

            // æª¢æŸ¥æ˜¯å¦æœ‰å®Œå…¨ç¬¦åˆçš„é…æ–¹
            for (let recipe of recipeList) {
                let match = true;
                // æª¢æŸ¥è©²é…æ–¹éœ€è¦çš„æ‰€æœ‰é£Ÿææ¬¡æ•¸
                for (let key in cart) {
                    let need = recipe.ingredients[key] || 0;
                    if (cart[key] !== need) {
                        match = false;
                        break;
                    }
                }
                if (match) {
                    successRecipe = recipe;
                    break;
                }
            }

            if (successRecipe) {
                // æˆåŠŸè£½ä½œ
                achievements.add(successRecipe.name);
                showResult(successRecipe);
                openModal("ç²å¾—æˆå°±", `æ­å–œè£½ä½œå‡ºã€${successRecipe.name}ã€‘ï¼`);
                
                // æª¢æŸ¥æ˜¯å¦å®Œæˆå…¨æˆå°± (å…±6ç¨®ï¼šç´…é¾œç²¿ã€èœé ­ç²¿ã€ç´…åœ“ã€è‰ä»”ç²¿ã€èŠ‹ç²¿ã€æ¹¯åœ“)
                if (achievements.size >= 6) {
                    document.getElementById('reward').style.display = 'block';
                }
            } else {
                // å¤±æ•—ï¼Œçµ¦äºˆéš¨æ©Ÿæç¤º
                giveHint();
            }
        }

        function showResult(recipe) {
            let img = document.getElementById('final-product');
            img.src = recipe.img; // æ­¤è™•æ‡‰ç‚ºæˆå“ç²¿çš„åœ–ç‰‡
            img.classList.add('show');
        }

        function giveHint() {
            // æ‰¾å‡ºé‚„æ²’è§£é–çš„ç²¿åç¨±
            const allNames = ["ç´…é¾œç²¿", "èœé ­ç²¿", "ç´…åœ“", "è‰ä»”ç²¿", "èŠ‹ç²¿", "æ¹¯åœ“"];
            const lockedNames = allNames.filter(name => !achievements.has(name));

            if (lockedNames.length > 0) {
                const targetName = lockedNames[Math.floor(Math.random() * lockedNames.length)];
                // æ‰¾åˆ°è©²åç¨±å°æ‡‰çš„å…¶ä¸­ä¸€å€‹é…æ–¹
                const hintRecipe = recipeList.find(r => r.name === targetName);
                
                let hintStr = "";
                for(let key in hintRecipe.ingredients) {
                    let cn = {red:'ç´…ç±³ç³°', white:'ç™½ç±³ç³°', green:'ç¶ ç±³ç³°', syrup:'ç±³æ¼¿', sweet:'ç”œé¤¡', salty:'é¹¹é¤¡'}[key];
                    hintStr += `${cn} x${hintRecipe.ingredients[key]}ã€`;
                }
                openModal("æœªé”æˆæˆå°±", `æç¤ºï¼šå˜—è©¦çœ‹çœ‹ç”¨ ${hintStr.slice(0, -1)} è£½ä½œåˆ¥çš„ç²¿é¡å§ï¼`);
            }
        }

        function openModal(title, desc) {
            document.getElementById('m-title').innerText = title;
            document.getElementById('m-desc').innerText = desc;
            document.getElementById('modal-overlay').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('modal-overlay').style.display = 'none';
        }
    </script>
</body>
</html>

