<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‰µæ„ç´…é¾œç²¿ DIY å·¥åŠ</title>
    <style>
        :root { --primary-red: #d32f2f; --leaf-green: #388e3c; }
        body { font-family: "Microsoft JhengHei", "PingFang TC", sans-serif; background-color: #fff9f0; color: #4e342e; display: flex; flex-direction: column; align-items: center; padding: 20px; margin: 0; }
        h1 { color: var(--primary-red); margin-bottom: 5px; }
        .container { background: white; padding: 20px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); max-width: 500px; width: 100%; text-align: center; }
        canvas { background-color: #fafafa; border: 4px solid #f0e6d2; border-radius: 15px; cursor: pointer; transition: transform 0.1s; touch-action: none; margin-bottom: 15px; }
        .status { background: #fff3e0; padding: 10px; border-radius: 10px; color: #e65100; font-weight: bold; margin-bottom: 15px; min-height: 24px; }
        .section { margin-bottom: 20px; text-align: left; }
        .section-label { font-weight: bold; margin-bottom: 8px; display: block; border-left: 4px solid var(--primary-red); padding-left: 8px; }
        .btn-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); gap: 8px; }
        button { padding: 8px; border: 2px solid #ddd; border-radius: 10px; background: white; cursor: pointer; transition: 0.2s; font-size: 14px; }
        button:hover { background: #fff5f5; border-color: var(--primary-red); }
        button.active { background: var(--primary-red); color: white; border-color: #b71c1c; }
        .reset-btn { width: 100%; padding: 12px; background: #5d4037; color: white; border: none; border-radius: 10px; font-weight: bold; margin-top: 10px; }
    </style>
</head>
<body>

    <h1>ğŸ® å‰µæ„ç´…é¾œç²¿ DIY ğŸ®</h1>
    <p>é¸çš®ã€é¸é¤¡ã€æ›æ¨¡å…·ï¼Œé»æ“Šç•«å¸ƒå£“è£½ä½ çš„å°ˆå±¬ç´…é¾œç²¿ï¼</p>

    <div class="container">
        <div id="status" class="status">è«‹å…ˆé¸æ“‡é¤…çš®é¡è‰²</div>
        
        <canvas id="gameCanvas" width="300" height="300"></canvas>

        <div class="section">
            <span class="section-label">1. é¤…çš®èˆ‡å…§é¤¡</span>
            <div class="btn-grid" id="skin-btns">
                <button onclick="setSkin('#ff5252', 'ç´…éº´', this)" class="active">ç¶“å…¸ç´…</button>
                <button onclick="setSkin('#9ccc65', 'è‰¾è‰', this)">è‰¾è‰ç¶ </button>
                <button onclick="setSkin('#ffd54f', 'åœ°ç“œ', this)">åœ°ç“œé»ƒ</button>
                <button onclick="setSkin('#ba68c8', 'ç´«è–¯', this)">ç´«è–¯ç´«</button>
            </div>
            <div class="btn-grid" style="margin-top:8px;" id="filling-btns">
                <button onclick="setFilling('ç´…è±†', this)">ç´…è±†é¤¡</button>
                <button onclick="setFilling('èŠ±ç”Ÿ', this)">èŠ±ç”Ÿé¤¡</button>
                <button onclick="setFilling('èŠéº»', this)">èŠéº»é¤¡</button>
            </div>
        </div>

        <div class="section">
            <span class="section-label">2. é¸æ“‡æ¨¡å…· (æ¬¾å¼)</span>
            <div class="btn-grid" id="mold-btns">
                <button onclick="setMold('å£½', this)" class="active">å‚³çµ±ã€å£½ã€‘</button>
                <button onclick="setMold('ç¦', this)">å‚³çµ±ã€ç¦ã€‘</button>
                <button onclick="setMold('â¤ï¸', this)">å¯æ„›ã€æ„›å¿ƒã€‘</button>
                <button onclick="setMold('ğŸ¾', this)">å¯æ„›ã€è‚‰çƒã€‘</button>
            </div>
        </div>
        
        <button class="reset-btn" onclick="resetGame()">ğŸ§¹ é‡æ–°è£½ä½œ</button>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const statusDiv = document.getElementById('status');

        let state = 'SKIN'; // SKIN, FILLING, READY, DONE
        let skinColor = '#ff5252';
        let filling = '';
        let moldType = 'å£½';

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // ç•«æœˆæ¡ƒè‘‰
            ctx.fillStyle = '#2e7d32';
            ctx.beginPath();
            ctx.ellipse(150, 195, 80, 120, Math.PI/2, 0, Math.PI*2);
            ctx.fill();
            ctx.strokeStyle = '#1b5e20';
            ctx.lineWidth = 1;
            ctx.stroke();

            // ç•«ç´…é¾œç²¿
            ctx.save();
            ctx.shadowBlur = 15;
            ctx.shadowColor = 'rgba(0,0,0,0.2)';
            ctx.fillStyle = skinColor;
            
            if (state === 'DONE') {
                // å£“å¹³å¾Œçš„å½¢ç‹€
                ctx.beginPath();
                ctx.ellipse(150, 180, 85, 110, Math.PI/2, 0, Math.PI*2);
                ctx.fill();
                drawPattern();
            } else {
                // åœ“éºµç³°
                ctx.beginPath();
                ctx.arc(150, 175, 70, 0, Math.PI*2);
                ctx.fill();
                // å…‰æ¾¤æ„Ÿ
                let grad = ctx.createRadialGradient(130, 150, 10, 150, 175, 70);
                grad.addColorStop(0, 'rgba(255,255,255,0.2)');
                grad.addColorStop(1, 'transparent');
                ctx.fillStyle = grad;
                ctx.fill();
            }
            ctx.restore();
        }

        function drawPattern() {
            ctx.strokeStyle = 'rgba(0,0,0,0.1)';
            ctx.lineWidth = 4;
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            
            // å¤–åœˆé¾œæ®¼ç´‹
            ctx.beginPath();
            ctx.ellipse(150, 180, 65, 90, Math.PI/2, 0, Math.PI*2);
            ctx.stroke();

            // æ ¹æ“šé¸æ“‡çš„æ¨¡å…·å°è£½åœ–æ¡ˆ
            ctx.font = moldType === 'å£½' || moldType === 'ç¦' ? "bold 60px serif" : "60px Arial";
            ctx.fillStyle = 'rgba(0,0,0,0.15)';
            ctx.fillText(moldType, 150, 185);
            
            // è£é£¾ç´°ç·š
            ctx.setLineDash([5, 5]);
            ctx.strokeRect(110, 150, 80, 60);
        }

        function setSkin(color, name, btn) {
            skinColor = color;
            updateActive(btn, 'skin-btns');
            if(state === 'SKIN') {
                state = 'FILLING';
                statusDiv.innerText = `é¸äº†${name}çš®ï¼Œæ¥è‘—é¸å…§é¤¡å§ï¼`;
            }
            draw();
        }

        function setFilling(f, btn) {
            filling = f;
            updateActive(btn, 'filling-btns');
            state = 'READY';
            statusDiv.innerText = `åŒ…å¥½äº†${f}é¤¡ï¼è«‹é»æ“Šéºµç³°å£“æ¨¡ï¼`;
            draw();
        }

        function setMold(m, btn) {
            moldType = m;
            updateActive(btn, 'mold-btns');
            if(state === 'DONE') draw(); // å¦‚æœå·²ç¶“åšå¥½äº†ï¼Œåˆ‡æ›æ¨¡å…·å³æ™‚æ›´æ–°
        }

        function updateActive(clickedBtn, parentId) {
            document.getElementById(parentId).querySelectorAll('button').forEach(b => b.classList.remove('active'));
            clickedBtn.classList.add('active');
        }

        canvas.addEventListener('mousedown', () => {
            if (state === 'READY') {
                state = 'DONE';
                statusDiv.innerText = `âœ¨ æ¼‚äº®çš„ ${moldType} æ¬¾ ${filling} ç´…é¾œç²¿å®Œæˆå›‰ï¼`;
                canvas.style.transform = 'scale(0.95)';
                setTimeout(() => { canvas.style.transform = 'scale(1)'; draw(); }, 100);
            }
        });

        function resetGame() {
            state = 'SKIN';
            filling = '';
            statusDiv.innerText = 'è«‹å…ˆé¸æ“‡é¤…çš®é¡è‰²';
            draw();
        }

        draw(); // åˆå§‹ç¹ªè£½
    </script>
</body>
</html>
